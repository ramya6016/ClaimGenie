<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Claim Genie</title>
<!-- Bootstrap CSS -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<style>
/* Custom CSS for navigation bar */
body{
    height: auto;
    background-image: url(sample.webp);
    background-repeat: no-repeat;
    background-size: cover;
    padding-bottom: 50px;
}
.navbar-custom {
    background-color: #144663; 
    display: flex;
  flex-direction: row;
  justify-content: space-between;
}

/* Custom CSS for sliding menu */
.sliding-menu {
    position: fixed;
    top: 0;
    left: -250px; /* Initially hidden */
    width: 250px;
    height: 100%;
    background-color: #333; /* Dark background */
    transition: left 0.3s ease-in-out; /* Smooth transition */
    z-index: 1000;
}

.sliding-menu ul {
    list-style-type: none;
    padding: 20px;
}

.sliding-menu ul li {
    margin-bottom: 10px;
}

.sliding-menu ul li a {
    color: #fff;
    text-decoration: none;
    font-size: 18px;
}

.sliding-menu ul li a:hover {
    color: #ccc;
}

/* Center the content */
.container {
    margin-top: 50px;
    text-align: center; /* Center content */
    animation:slideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) normal;
}
@keyframes slideIn {
  from { transform: translateY(-100%); }
  to { transform: translateY(0); }
}

.close-icon {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
    font-size: 24px;
    color: #fff;
}
.close-icon-result {
    cursor: pointer;
    font-size: 24px;
    color: black;
}
.nav-links{
    text-decoration: none;
    padding: 15px;
   color: #fff;}
.nav-links:hover{
    text-decoration: none;
    color: #fff;
}
h2{
    font-weight: bold;
}
.customer-container{
    display: flex;
    height: 80vh;
   
    flex-wrap: wrap;
    flex-direction: column;
    justify-content: space-evenly;
    border: 1px solid #000000;
    border-radius: 10px;
    background-color: #ffffff;
}
.result-container {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    align-items: stretch; /* Ensure the container stretches to fit its content */
    border: 1px solid #000000;
    border-radius: 10px;
    background-color: #ffffff;
    max-height: 80vh; /* Set maximum height */
    overflow-y: auto; /* Enable vertical scrolling */
    padding: 10px; /* Add padding for better appearance */
    justify-content: center;
}
.results-container {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    align-items: stretch; /* Ensure the container stretches to fit its content */
    background-color: #ffffff;
    max-height: 80vh; /* Set maximum height */
    overflow-y: auto; /* Enable vertical scrolling */
    padding: 10px; /* Add padding for better appearance */
    justify-content: center;
}
.result-section {
    width:15vw;
    margin: 10px;
    padding: 15px;
    
    text-align: left;
    
}

.result-section-header {
    cursor: pointer;
    font-weight: bold;
    
}

.result-section-content {
    display: none;
    
}

.button {
  min-width: 150px;
  min-height: 60px;
  font-family: 'Nunito', sans-serif;
  font-size: 22px;
  text-transform: uppercase;
  letter-spacing: 1.3px;
  font-weight: 700;
  color: #ffffff;
  background: #144663;
background:  linear-gradient(0deg, rgba(20,70,68,1) 0%, rgba(20,70,99,1) 51%, rgba(20,70,68,1) 100%);
  border: none;
  border-radius: 1000px;
  box-shadow: 12px 12px 24px rgba(20,70,99,.64);
  transition: all 0.3s ease-in-out 0s;
  cursor: pointer;
  outline: none;
  position: relative;
  padding: 10px;
  }

.button::before {
content: '';
  border-radius: 1000px;
  min-width: calc(150px + 12px);
  min-height: calc(60px + 12px);
  border: 6px solid #144663;
  box-shadow: 0 0 60px rgba(20,70,99,.64);
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  opacity: 0;
  transition: all .3s ease-in-out 0s;
}

.button:hover, .button:focus {
  color: #ffffff;
  transform: translateY(-6px);
}

.button:hover::before, .button:focus::before {
  opacity: 1;
}

.button::after {
  content: '';
  width: 30px; height: 30px;
  border-radius: 100%;
  border: 6px solid #144663;
  position: absolute;
  z-index: -1;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  animation: ring 1.5s infinite;
}

.button:hover::after, .button:focus::after {
  animation: none;
  display: none;
}

@keyframes ring {
  0% {
    width: 30px;
    height: 30px;
    opacity: 1;
  }
  100% {
    width: 300px;
    height: 300px;
    opacity: 0;
  }
}
.dropdown-menus{
    height: 95px;
}
.dropdown-item-back :active{
    background-color:  #144663;
}
.dropdown-item-back{
    color: #144663;
    border-bottom: 2px solid #144663;
}

.dropdown-item{
    transition: all .3s ease-in-out 0s;
    font-size: x-large;
}
.connection{
    display: flex;
    justify-content: center;
    margin-top: 50px;
}
.connection input{
    width: 20vw;
    outline: none;
    border: none;
    border-bottom:1px solid #144663;
    color: #144663;
}
#drop-zone {
  width: 20vw;
  height: 50px;
  border: 2px dashed #ccc;
  text-align: center;
  padding: 20px;
  margin: 20px auto;
  display:flex;
  justify-content: center;
    align-items: center;
}
#drop-zone span span{
    font-size: larger;
    color:#144663;
    font-weight: bold;
    
}
#file-input {
  display: none;
}
.display-none{
    display: none;
}
.arrow {
    margin-right: 10px; /* Add some space between arrow and text */
}
</style>
</head>
<body>
    
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom">
        <button class="navbar-toggler custom-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" onclick="toggleMenu()">
            <span class="navbar-toggler-icon"><i class="bi bi-list"></i></span>
        </button>
        <h2> <a class="navbar-brand  mx-auto" href="#">Claim Genie</a></h2>
       <nav class="navbar navbar-custom d-none d-lg-block font-weight-bold text-white "> 

            <!-- Links -->
            <ul class="navbar-nav navbar-custom ">
                <span><a class="nav-links" href="#">Home</a></span>
                <span><a class="nav-links" href="#">About Us</a></span>
            </ul>
          
          </nav> 
    </nav>
    
    
    
    <div class="sliding-menu" id="slidingMenu">
        <!-- Close icon -->
        <span class="close-icon" onclick="closeToggleMenu()">&times;</span>
    
        <!-- Menu items -->
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">About Us</a></li>
        </ul>
    </div>
    
    
<div id="customer" class="container customer-container">
    <div>
    <h1 class="mt-3">Claim Extraction</h1>
</div>
    <!-- Dropdown menu to select action -->
    <div class="dropdown-menus">
    <!-- <div class="dropdown mt-3">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Select Action
        </button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#" onclick="selectAction('recording')">Voice Recording</a>
            <a class="dropdown-item" href="#" onclick="selectAction('image')">Call Transcript</a>
            <a class="dropdown-item" href="#" onclick="selectAction('document')">Document Upload</a>
            <a class="dropdown-item" href="#" onclick="selectAction('audio')">Audio Upload</a>
        </div>
    </div> -->
    <!--<div class="form-check form-check-inline">
        <a class="dropdown-item" href="#" id="Voice" onclick="selectAction('recording')">Voice Recording</a>
      </div>-->
      
     <!-- <div class="form-check form-check-inline">
        <a class="dropdown-item" href="#" id="images" onclick="selectAction('image')">Call Transcript</a>
      </div> -->
      <div class="form-check form-check-inline">
        <a class="dropdown-item" href="#" id="BIOS" onclick="selectAction('BIOS')">Azure Blob Details</a>
      </div>
      <div class="form-check form-check-inline">
        <a class="dropdown-item" href="#" id="audios" onclick="selectAction('audio')">Audio/Document Upload</a>
      </div>
    <!-- Voice Recording buttons -->
    <div id="recordingButtons" class="mt-3" style="display: none;">
        <button class="btn btn-primary mr-2" onclick="startRecording()">Start Recording</button>
        <button class="btn btn-danger" onclick="stopRecording()">Stop Recording</button>
    </div>

    <!-- Image Scanning button -->
    <div id="imageButton" class="mt-3" style="display: none;">
        <input type="file" accept="image/*" onchange="scanImage(event)" class="form-control-file">
    </div>

    <!-- Document Upload (MP3/MP4) button -->
    <div id="BIOSButton" class="mt-3" style="display: none;">
        <div class="connection">
       <span class="font-weight-bold"> Connection String : &nbsp;</span><span> <input type="text" class="form-control-file"></span>
       </div>
    </div>

    <!-- Audio Upload button -->
    <div id="audioButton" class="mt-3" style="display: none;">
        <div class="connection">
        <!-- <input type="file"  class="form-control-file"> -->
        <div id="drop-zone">
            <span>Drag and drop file here or click to <span> Browse </span></span>
            <input type="file" id="file-input" >
          </div>
          
    </div>
    </div>
</div>

    <!-- Submit Button -->
    <!-- <div class="mt-4">
        <button class="btn btn-success" >Submit</button>
    </div> -->
    

<div class="wrap">
    <button class="button" onclick="submitForm()">Submit</button>
    <button class="button" onclick="redirectAndAPICall()">Review Results</button>

  </div>
  
  
</div>
<!--<div id="result" class="container result-container display-none">

    <div>
    <h1 class="mt-3">Result <span class="close-icon-result" onclick="closeToggleResult()">&times;</span></h1> 
    <div id="results" class="container results-container" > </div> -->
    <!-- Dropdown menu to select action -->
   <!--</div>--> 

  
  
</div>

<!-- Bootstrap JS and jQuery (required for Bootstrap) -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

<script>
// JavaScript code for toggling sliding menu
function redirectAndAPICall() {
    // Make an AJAX GET request
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "https://insurance-extraction.azurewebsites.net/review", true);
    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4 && xhr.status === 200) {
        // Parse the JSON response
        var response = JSON.parse(xhr.responseText);
        console.log(response)
        // Extract the data you want to pass
        var dataToPass = response.file_names;
        dataToPass={'List':dataToPass};
        console.log(dataToPass);
        // Redirect to the next page with data encoded in URL parameters
        window.location.href = "test.html?data=" + encodeURIComponent(JSON.stringify(dataToPass));
      }
      //dataToPass={'List':['file1.json','file2.json','file3.json']}
      //window.location.href = "test.html?data=" + encodeURIComponent(JSON.stringify(dataToPass));
    };
    xhr.send();
  }
var selectedAction;
function closeToggleResult() {
    document.getElementById("result").style.display='none'
    document.getElementById('customer').style.visibility = 'visible';
    
}
function toggleMenu() {
    var slidingMenu = document.getElementById('slidingMenu');
    if (slidingMenu.style.left === '-250px') {
        slidingMenu.style.left = '0';
    } else {
        slidingMenu.style.left = '-250px';
    }
}
function closeToggleMenu() {
    var slidingMenu = document.getElementById('slidingMenu');
    slidingMenu.style.left = '-250px';
}
var audioFile;
// JavaScript code for selecting action
function selectAction(action) {
    selectedAction = action;
    // Hide all action buttons
    //document.getElementById('recordingButtons').style.display = 'none';
    //document.getElementById('imageButton').style.display = 'none';
    document.getElementById('BIOSButton').style.display = 'none';
    document.getElementById('audioButton').style.display = 'none';
    
    //document.getElementById('Voice').classList.remove('dropdown-item-back');
    
    document.getElementById('BIOS').classList.remove('dropdown-item-back');
    
    //document.getElementById('documents').classList.remove('dropdown-item-back');
    
    document.getElementById('audios').classList.remove('dropdown-item-back');
    // Show buttons based on selected action
    if (action === 'recording') {
        document.getElementById('recordingButtons').style.display = 'block';
        document.getElementById('Voice').classList.add('dropdown-item-back');
    } else if (action === 'image') {
        document.getElementById('imageButton').style.display = 'block';
        
        document.getElementById('images').classList.add('dropdown-item-back');
    } else if (action === 'BIOS') {
        document.getElementById('BIOSButton').style.display = 'block';
        
        document.getElementById('BIOS').classList.add('dropdown-item-back');
    } else if (action === 'audio') {
        document.getElementById('audioButton').style.display = 'block';
        
        document.getElementById('audios').classList.add('dropdown-item-back');
    }
}
selectAction('audio')
function submitForm() {
    // Check if audio file is selected
    //const resultContainer = document.getElementById("result").style.display='block';
    //document.getElementById('customer').style.visibility = 'hidden';
    //document.getElementById('customer').style.overflow='hidden';
    //document.getElementById("result").style.display='block';
    //document.getElementById("result").scrollIntoView({  behavior: "smooth", block: "start" });
    if (selectedAction === 'BIOS') {
        var biosText = document.getElementById('BIOSButton').getElementsByTagName('input')[0].value;
        console.log('Submitting BIOS text:', biosText);
    } else if (selectedAction === 'audio') 
    {
      //var fileInput = document.getElementById('file-input');
    
    // Check if a file input element exists
    //var audioFile = document.getElementById('drop-zone').getElementsByTagName('input')[0].files[0];
    //var audioFile = document.getElementById('file-input').files[0];


      console.log(audioFile)
        
        if (audioFile) {
            console.log('Submitting audio file:', audioFile);
            
            var formData = new FormData();
            formData.append ("files",audioFile);

        // You can use fetch or XMLHttpRequest to send the audio file to the server
        // Example using fetch:
            fetch('https://insurance-extraction.azurewebsites.net/upload-files', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    // Audio submitted successfully, you can show a success message or redirect
                    console.log('Document submitted successfully');
                    alert("Document submitted successfully!");
                    //esultContainer.classList.remove("display-none");
                  }  
                    
                else {
                // Audio submission failed
                console.error('Error submitting Document');
                alert("Error submitting Document. Please Try again");
                }
        })
        .catch(error => {
            console.error('Error:', error);
        });
        } 
        else {
            console.error('No audio file selected');
        }
    }

    // Show the result container
    
}
    

  
    


const dropZone = document.getElementById('drop-zone');
const fileInput = document.getElementById('file-input');

dropZone.addEventListener('dragover', (event) => {
  event.preventDefault();
  dropZone.classList.add('highlight'); 
});

dropZone.addEventListener('dragleave', () => {
  dropZone.classList.remove('highlight'); 
});

dropZone.addEventListener('drop', (event) => {
  event.preventDefault();
  const files = event.dataTransfer.files;
  console.log('Dropped files:', files);
});

dropZone.addEventListener('click', () => {
  fileInput.click(); 
});
dropZone.addEventListener('dragover', (event) => {
  event.preventDefault();
  dropZone.textContent = 'Dragging a file...'; 
  dropZone.classList.add('highlight'); 
});

dropZone.addEventListener('dragleave', () => {
  dropZone.textContent = 'Drag and drop files here or click to browse';
  dropZone.classList.remove('highlight'); 
});

function formatFileSize(bytes) {
  const units = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
  let i = 0;
  while (bytes >= 1024 && i < units.length - 1) {
    bytes /= 1024;
    i++;
  }
  return `${bytes.toFixed(1)} ${units[i]}`;
}
dropZone.addEventListener('drop', (event) => {
  event.preventDefault();
  const files = event.dataTransfer.files;
  const fileName = files[0].name; // Access first file name
  const fileSize = formatFileSize(files[0].size);
   audioFile=files[0];
  // Update drop zone content with filename
  dropZone.textContent = `Dropped file: ${fileName} (${fileSize})`;
  console.log('Dropped files:', files);
});
dropZone.addEventListener('change', (event) => {
  event.preventDefault();
  const files = event.target.files;
  const fileName = files[0].name;
  const fileSize = formatFileSize(files[0].size) 
  audioFile=files[0];

  dropZone.textContent = `Selected file: ${fileName} (${fileSize})`;
  console.log('Selected files:', files);
});
</script>
</body>
</html>
